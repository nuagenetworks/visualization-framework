{
    "id": "inf-testbed-failure-express",
    "title": "",
    "service": "elasticsearch",
    "query": {
      "index": "nuage_regress",
      "type": "nuage_doc_type",
      "body": {
        "size": 0,
        "query": {
          "bool": {
            "must": [
              {
                "range": {
                  "time_regression_started": {
                    "gte": "{{startTime:now-7d}}",
                    "lte": "{{endTime:now}}",
                    "format": "epoch_millis"
                  }
                }
              },
              {
                "term": {
                  "testcase": ""
                }
              },
              {
                "regexp":{
                  "testbed":"(.*infra.*|mvnsgdev21|mvnsgdev22)"
                }
              },
              {
                "terms": {
                  "testsuite": [
                    "initial",
                    "sanity",
                    "Sanity"
                  ]
                }
              }
            ]
          }
        },
        "aggs": {
          "testbed": {
            "terms": {
              "field": "testbed",
              "size":200
            }, 
                "aggs": {
                  "result": {
                    "terms": {
                      "script": {
                        "inline": "doc['result'].value !=2 ? 'Infra Issues' : 'Passed/Non-Infra Issues'"
                      }
                    }
                  }
                }
              }
            }
          }
        
      
    }
  }
    